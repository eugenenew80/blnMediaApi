<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.3.xsd">

    <changeSet id="media-eug-87"  logicalFilePath="path-independent" author="eugene" context="postgres">
        <dropTable schemaName="apps" tableName="media_day_metering_data_oper"/>
        <dropSequence sequenceName="media_day_metering_data_oper_s" schemaName="apps" />
        <rollback>
            <createTable tableName="media_day_metering_data_oper" schemaName="apps">
                <column name="id" type="number">
                    <constraints nullable="false"/>
                </column>

                <column name="metering_point_id" type="number">
                    <constraints nullable="false"/>
                </column>

                <column name="meter_id" type="number">
                    <constraints nullable="true"/>
                </column>

                <column name="param_code" type="varchar(4)">
                    <constraints nullable="false"/>
                </column>

                <column name="unit_code" type="varchar(10)">
                    <constraints nullable="false"/>
                </column>

                <column name="oper_date" type="date">
                    <constraints nullable="false"/>
                </column>

                <column name="data_source_code" type="varchar(15)">
                    <constraints nullable="false"/>
                </column>

                <column name="way_entering" type="varchar(15)">
                    <constraints nullable="false"/>
                </column>

                <column name="start_balance" type="number">
                    <constraints nullable="true"/>
                </column>

                <column name="end_balance" type="number">
                    <constraints nullable="true"/>
                </column>

                <column name="dif" type="number">
                    <constraints nullable="true"/>
                </column>

                <column name="create_date" type="TIMESTAMP WITHOUT TIME ZONE">
                    <constraints nullable="true"/>
                </column>

                <column name="last_update_date" type="TIMESTAMP WITHOUT TIME ZONE">
                    <constraints nullable="true"/>
                </column>

                <column name="create_by" type="number">
                    <constraints nullable="true"/>
                </column>

                <column name="last_update_by" type="number">
                    <constraints nullable="true"/>
                </column>
            </createTable>

            <addPrimaryKey
                    columnNames="id"
                    constraintName="pk_media_day_metering_data_oper"
                    schemaName="apps"
                    tableName="media_day_metering_data_oper"/>

            <createSequence
                    incrementBy="1"
                    schemaName="apps"
                    sequenceName="media_day_metering_data_oper_s"
                    startValue="1"/>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-88" logicalFilePath="path-independent" author="eugene" context="postgres">
        <dropTable schemaName="apps" tableName="media_month_metering_data_oper"/>
        <dropSequence sequenceName="media_month_metering_data_oper_s" schemaName="apps" />
        <rollback>
            <createTable tableName="media_month_metering_data_oper" schemaName="apps">
                <column name="id" type="number">
                    <constraints nullable="false"/>
                </column>

                <column name="metering_point_id" type="number">
                    <constraints nullable="false"/>
                </column>

                <column name="meter_id" type="number">
                    <constraints nullable="true"/>
                </column>

                <column name="param_code" type="varchar(4)">
                    <constraints nullable="false"/>
                </column>

                <column name="unit_code" type="varchar(10)">
                    <constraints nullable="false"/>
                </column>

                <column name="oper_year" type="number">
                    <constraints nullable="false"/>
                </column>

                <column name="oper_month" type="number">
                    <constraints nullable="false"/>
                </column>

                <column name="data_source_code" type="varchar(15)">
                    <constraints nullable="false"/>
                </column>

                <column name="way_entering" type="varchar(15)">
                    <constraints nullable="false"/>
                </column>

                <column name="start_balance" type="number">
                    <constraints nullable="true"/>
                </column>

                <column name="end_balance" type="number">
                    <constraints nullable="true"/>
                </column>

                <column name="dif" type="number">
                    <constraints nullable="true"/>
                </column>

                <column name="create_date" type="TIMESTAMP WITHOUT TIME ZONE">
                    <constraints nullable="true"/>
                </column>

                <column name="last_update_date" type="TIMESTAMP WITHOUT TIME ZONE">
                    <constraints nullable="true"/>
                </column>

                <column name="create_by" type="number">
                    <constraints nullable="true"/>
                </column>

                <column name="last_update_by" type="number">
                    <constraints nullable="true"/>
                </column>
            </createTable>

            <addPrimaryKey
                    columnNames="id"
                    constraintName="pk_media_month_metering_data_oper"
                    schemaName="apps"
                    tableName="media_month_metering_data_oper"/>

            <createSequence
                    incrementBy="1"
                    schemaName="apps"
                    sequenceName="media_month_metering_data_oper_s"
                    startValue="1"/>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-89" failOnError="false" logicalFilePath="path-independent" author="eugene" context="postgres">
        <dropTable schemaName="apps" tableName="media_template_metering_reading"/>
        <dropSequence sequenceName="media_template_metering_reading_s" schemaName="apps" />
        <rollback>
            <createTable tableName="media_template_metering_reading" schemaName="apps">
                <column name="id" type="number">
                    <constraints nullable="false"/>
                </column>

                <column name="doc_type_id" type="number">
                    <constraints nullable="false"/>
                </column>

                <column name="name" type="varchar(100)">
                    <constraints nullable="false"/>
                </column>

                <column name="header" type="varchar(300)">
                    <constraints nullable="true"/>
                </column>

                <column name="group_id" type="number">
                    <constraints nullable="false"/>
                </column>
            </createTable>

            <addPrimaryKey
                    columnNames="id"
                    constraintName="pk_media_template_metering_reading"
                    schemaName="apps"
                    tableName="media_template_metering_reading"/>

            <createSequence
                    incrementBy="1"
                    schemaName="apps"
                    sequenceName="media_template_metering_reading_s"
                    startValue="1"/>
        </rollback>
    </changeSet>


    <changeSet id="media-eug-90" logicalFilePath="path-independent" author="eugene" context="postgres">
        <dropColumn columnName="way_entering" schemaName="apps" tableName="media_doc_metering_reading_lines"/>
        <rollback>
            <addColumn schemaName="apps" tableName="media_doc_metering_reading_lines">
                <column name="way_entering" type="varchar(15)"/>
            </addColumn>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-91" logicalFilePath="path-independent" author="eugene" context="postgres">
        <dropColumn columnName="way_entering" schemaName="apps" tableName="media_day_metering_balance_raw"/>
        <rollback>
            <addColumn schemaName="apps" tableName="media_day_metering_balance_raw">
                <column name="way_entering" type="varchar(15)"/>
            </addColumn>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-92" logicalFilePath="path-independent" author="eugene" context="postgres">
        <dropColumn columnName="way_entering" schemaName="apps" tableName="media_hour_metering_data_raw"/>
        <rollback>
            <addColumn schemaName="apps" tableName="media_hour_metering_data_raw">
                <column name="way_entering" type="varchar(15)"/>
            </addColumn>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-93" logicalFilePath="path-independent" author="eugene" context="postgres">
        <dropColumn columnName="way_entering" schemaName="apps" tableName="media_day_metering_data_raw"/>
        <rollback>
            <addColumn schemaName="apps" tableName="media_day_metering_data_raw">
                <column name="way_entering" type="varchar(15)"/>
            </addColumn>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-94" logicalFilePath="path-independent" author="eugene" context="postgres">
        <dropColumn columnName="way_entering" schemaName="apps" tableName="media_month_metering_data_raw"/>
        <rollback>
            <addColumn schemaName="apps" tableName="media_month_metering_data_raw">
                <column name="way_entering" type="varchar(15)"/>
            </addColumn>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-95" logicalFilePath="path-independent" author="eugene" context="postgres">
        <addColumn schemaName="apps" tableName="media_hour_metering_data_raw">
            <column name="metering_point_id" type="number" />
            <column name="meter_id"          type="number" />
        </addColumn>
    </changeSet>

    <changeSet id="media-eug-96" logicalFilePath="path-independent" author="eugene" context="postgres">
        <addColumn schemaName="apps" tableName="media_day_metering_data_raw">
            <column name="metering_point_id" type="number" />
            <column name="meter_id"          type="number" />
        </addColumn>
    </changeSet>

    <changeSet id="media-eug-97" logicalFilePath="path-independent" author="eugene" context="postgres">
        <addColumn schemaName="apps" tableName="media_month_metering_data_raw">
            <column name="metering_point_id" type="number" />
            <column name="meter_id"          type="number" />
        </addColumn>
    </changeSet>

    <changeSet id="media-eug-98" logicalFilePath="path-independent" author="eugene" context="postgres">
        <renameColumn
                      columnDataType="varchar(15)"
                      newColumnName="data_source"
                      oldColumnName="data_source_code"
                      schemaName="apps"
                      tableName="media_day_metering_balance_raw"/>
    </changeSet>

    <changeSet id="media-eug-99" logicalFilePath="path-independent" author="eugene" context="postgres">
        <renameColumn
                      columnDataType="varchar(15)"
                      newColumnName="data_source"
                      oldColumnName="data_source_code"
                      schemaName="apps"
                      tableName="media_hour_metering_data_raw"/>
    </changeSet>

    <changeSet id="media-eug-100" logicalFilePath="path-independent" author="eugene" context="postgres">
        <renameColumn
                      columnDataType="varchar(15)"
                      newColumnName="data_source"
                      oldColumnName="data_source_code"
                      schemaName="apps"
                      tableName="media_day_metering_data_raw"/>
    </changeSet>

    <changeSet id="media-eug-101" logicalFilePath="path-independent" author="eugene" context="postgres">
        <renameColumn
                      columnDataType="varchar(15)"
                      newColumnName="data_source"
                      oldColumnName="data_source_code"
                      schemaName="apps"
                      tableName="media_month_metering_data_raw"/>
    </changeSet>

    <changeSet id="media-eug-102" logicalFilePath="path-independent" author="eugene" context="postgres">
        <renameTable
                     newTableName="media_hour_metering_flow"
                     oldTableName="media_hour_metering_data_raw"
                     schemaName="apps"/>
    </changeSet>

    <changeSet id="media-eug-103" logicalFilePath="path-independent" author="eugene" context="postgres">
        <renameTable
                     newTableName="media_day_metering_flow"
                     oldTableName="media_day_metering_data_raw"
                     schemaName="apps"/>
    </changeSet>

    <changeSet id="media-eug-104" logicalFilePath="path-independent" author="eugene" context="postgres">
        <renameTable
                     newTableName="media_month_metering_flow"
                     oldTableName="media_month_metering_data_raw"
                     schemaName="apps"/>
    </changeSet>


    <changeSet id="media-eug-105" logicalFilePath="path-independent" author="eugene" context="postgres">
        <renameTable
                newTableName="media_day_metering_balance"
                oldTableName="media_day_metering_balance_raw"
                schemaName="apps"/>
    </changeSet>

    <changeSet id="media-eug-106" logicalFilePath="path-independent" author="eugene" context="postgres">
        <sql dbms="postgresql">ALTER SEQUENCE  apps.media_day_metering_balance_raw_s RENAME TO media_day_metering_balance_s;</sql>
        <rollback>
            <sql dbms="postgresql">ALTER SEQUENCE apps.media_day_metering_balance_s RENAME TO media_day_metering_balance_raw_s;</sql>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-107" logicalFilePath="path-independent" author="eugene" context="postgres">
        <sql dbms="postgresql">ALTER SEQUENCE  apps.media_hour_metering_data_raw_s RENAME TO media_hour_metering_flow_s;</sql>
        <rollback>
            <sql dbms="postgresql">ALTER SEQUENCE  apps.media_hour_metering_flow_s RENAME TO media_hour_metering_data_raw_s;</sql>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-108" logicalFilePath="path-independent" author="eugene" context="postgres">
        <sql dbms="postgresql">ALTER SEQUENCE  apps.media_day_metering_data_raw_s RENAME TO media_day_metering_flow_s;</sql>
        <rollback>
            <sql dbms="postgresql">ALTER SEQUENCE  apps.media_day_metering_flow_s RENAME TO media_day_metering_data_raw_s;</sql>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-109" logicalFilePath="path-independent" author="eugene" context="postgres">
        <sql dbms="postgresql">ALTER SEQUENCE  apps.media_month_metering_data_raw_s RENAME TO media_month_metering_flow_s;</sql>
        <rollback>
            <sql dbms="postgresql">ALTER SEQUENCE  apps.media_month_metering_flow_s RENAME TO media_month_metering_data_raw_s;</sql>
        </rollback>
    </changeSet>


    <changeSet id="media-eug-110" logicalFilePath="path-independent" author="eugene" context="postgres">
        <sql dbms="oracle">RENAME apps.media_day_metering_balance_raw_s TO media_day_metering_balance_s;</sql>
        <rollback>
            <sql dbms="oracle">RENAME apps.media_day_metering_balance_s TO media_day_metering_balance_raw_s;</sql>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-111" logicalFilePath="path-independent" author="eugene" context="postgres">
        <sql dbms="oracle">RENAME apps.media_hour_metering_data_raw_s TO media_hour_metering_flow_s;</sql>
        <rollback>
            <sql dbms="oracle">RENAME apps.media_hour_metering_flow_s TO media_hour_metering_data_raw_s;</sql>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-112" logicalFilePath="path-independent" author="eugene" context="postgres">
        <sql dbms="oracle">RENAME apps.media_day_metering_data_raw_s TO media_day_metering_flow_s;</sql>
        <rollback>
            <sql dbms="oracle">RENAME apps.media_day_metering_flow_s TO media_day_metering_data_raw_s;</sql>
        </rollback>
    </changeSet>

    <changeSet id="media-eug-113" logicalFilePath="path-independent" author="eugene" context="postgres">
        <sql dbms="oracle">RENAME apps.media_month_metering_data_raw_s TO media_month_metering_flow_s;</sql>
        <rollback>
            <sql dbms="oracle">RENAME apps.media_month_metering_flow_s TO media_month_metering_data_raw_s;</sql>
        </rollback>
    </changeSet>


</databaseChangeLog>
